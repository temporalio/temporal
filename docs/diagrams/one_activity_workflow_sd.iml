'Sequence Diagram of one activity workflow

@startuml
!pragma teoz true

actor Client
participant WorkflowWorker
participant ActivityWorker
control Temporal
database History
database WorkflowTaskQueue
database ActivityTaskQueue

== Start Workflow Execution ==

Client->Temporal: StartWorkflowExecution
activate Temporal

group atomic
  Temporal->History:Add WorkflowExecutionStartedEvent
  History-->Temporal

  Temporal -> WorkflowTaskQueue: Add DecisionTask
  WorkflowTaskQueue --> Temporal

  Temporal -> History: Add DecisionTaskScheduledEvent
  History-->Temporal
end
Temporal --> Client: StartWorkflowExecution

deactivate Temporal

== Process Decision Task ==

WorkflowWorker -> Temporal: PollForDecisionTask
activate Temporal

  Temporal -> WorkflowTaskQueue: PollForDecisionTask
  WorkflowTaskQueue --> Temporal: PollForDecisionTask

  Temporal -> History: Add DecisionTaskStartedEvent
  History-->Temporal

{start} Temporal --> WorkflowWorker: PollForDecisionTask
deactivate Temporal

activate WorkflowWorker
ref over WorkflowWorker: Perform Workflow Logic

  WorkflowWorker->WorkflowWorker: ScheduleActivityTaskDecision

{end}  WorkflowWorker->Temporal: RespondDecisionTaskCompleted
  activate Temporal

'  {start} <-> {end}  : DecisionTaskTimeout
group atomic
    Temporal->History: Add DecisionTaskCompletedEvent
    History-->Temporal

    Temporal->History: Add ActivityTaskScheduledEvent
    History-->Temporal

    Temporal->ActivityTaskQueue: Add ActivityTask
    ActivityTaskQueue-->Temporal
end
  Temporal-->WorkflowWorker: RespondDecisionTaskCompleted
  deactivate Temporal
deactivate WorkflowWorker

== Process Activity Task ==

ActivityWorker->Temporal: PollForActivityTask
activate Temporal

  Temporal->ActivityTaskQueue: PollForActivityTask
  ActivityTaskQueue-->Temporal: PollForActivityTask

  Temporal->History: Add ActivityTaskStartedEvent
  History-->Temporal

  Temporal-->ActivityWorker:PollForActivityTask

deactivate Temporal

activate ActivityWorker
ref over ActivityWorker: Perform Activity Logic

  ActivityWorker->Temporal:RespondActivityTaskCompleted
  activate Temporal
group atomic
    Temporal->History:Add ActivityTaskCompletedEvent
    History-->Temporal

    Temporal -> WorkflowTaskQueue: Add DecisionTask
    WorkflowTaskQueue --> Temporal

    Temporal -> History: Add DecisionTaskScheduledEvent
    History-->Temporal
end
  Temporal-->ActivityWorker
  deactivate Temporal

deactivate ActivityWorker

== Process Decision Task ==

WorkflowWorker -> Temporal: PollForDecisionTask
activate Temporal

  Temporal -> WorkflowTaskQueue: PollForDecisionTask
  WorkflowTaskQueue --> Temporal: PollForDecisionTask

  Temporal -> History: Add DecisionTaskStartedEvent
  History-->Temporal

Temporal --> WorkflowWorker: PollForDecisionTask
deactivate Temporal

activate WorkflowWorker
ref over WorkflowWorker: Perform Workflow Logic

  WorkflowWorker->WorkflowWorker: CompleteWorkflowExecutionDecision
  WorkflowWorker->Temporal: RespondDecisionTaskCompleted
  activate Temporal
group atomic
    Temporal->History: Add DecisionTaskCompletedEvent
    History-->Temporal

    Temporal->History: Add WorkflowExecutionCompletedEvent
    History-->Temporal
end
  Temporal-->WorkflowWorker: RespondDecisionTaskCompleted
  deactivate Temporal

deactivate WorkflowWorker

@enduml